<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Soc Climb Studio</title>
    <link rel="stylesheet" href="/static/styles.css?v=20260211-websearch-switch" />
  </head>
  <body>
    <div class="app-shell">
      <header class="topbar">
        <div>
          <h1>Soc Climb Studio</h1>
          <p>View the social graph and manage people and ties.</p>
        </div>
        <button id="refresh-btn" class="btn btn-secondary">Refresh Graph</button>
      </header>

      <main class="layout">
        <section class="graph-panel">
          <div id="graph"></div>
          <div id="edge-details" class="edge-details hidden">
            <h3>Selected Edge</h3>
            <p id="edge-summary"></p>
          </div>
        </section>

        <aside class="sidebar">
          <section class="card">
            <h2>Add / Update Person</h2>
            <form id="add-person-form" class="stack-form">
              <label>
                ID
                <input type="text" name="id" required />
              </label>
              <label>
                Name
                <input type="text" name="name" />
              </label>
              <label>
                Family
                <input type="text" name="family" />
              </label>
              <label>
                Location
                <input type="text" name="location" />
              </label>
              <label>
                Tier (1-4)
                <input type="number" name="tier" min="1" max="4" />
              </label>
              <label>
                Dependency Weight (1-5)
                <input type="number" name="dependency_weight" min="1" max="5" value="3" />
              </label>
              <label>
                Schools (comma-separated)
                <input type="text" name="schools" placeholder="Harvard, MIT" />
              </label>
              <label>
                Employers (comma-separated)
                <input type="text" name="employers" placeholder="Acme Corp, Beta Ventures" />
              </label>
              <label>
                Ecosystems (comma-separated)
                <input type="text" name="ecosystems" placeholder="fintech, media" />
              </label>
              <label>
                Close Connections (comma-separated IDs)
                <input type="text" name="close_connections" placeholder="alice_smith, bob_lee" />
              </label>
              <label>
                Platforms (`key=value`, one per line)
                <textarea
                  name="platforms"
                  rows="3"
                  placeholder="x=@example&#10;linkedin=example"
                ></textarea>
              </label>
              <label>
                Societies (`key=rank`, one per line, rank 1-5)
                <textarea
                  name="societies"
                  rows="3"
                  placeholder="ivy_club=1&#10;book_society=3"
                ></textarea>
              </label>
              <label>
                Decision Nodes (JSON array)
                <textarea
                  name="decision_nodes"
                  rows="5"
                  placeholder='[{"org":"Acme","role":"Board Member","start":"2020-01-01","end":null}]'
                ></textarea>
              </label>
              <label>
                Family Links (JSON array)
                <textarea
                  name="family_links"
                  rows="4"
                  placeholder='[{"person_id":"jane_doe","relationship":"cousin","alliance_signal":true}]'
                ></textarea>
              </label>
              <label>
                Notes
                <textarea name="notes" rows="4" placeholder="Freeform notes"></textarea>
              </label>
              <button type="submit" class="btn">Save Person</button>
            </form>
          </section>

          <section class="card">
            <h2>Extract From Image</h2>
            <div id="image-dropzone" class="image-dropzone" tabindex="0">
              Paste (`Ctrl+V`) or drop an image here
            </div>
            <label class="file-picker-label">
              Or choose file
              <input id="image-file-input" type="file" accept="image/*" />
            </label>
            <div id="image-preview-wrap" class="image-preview-wrap hidden">
              <img id="image-preview" alt="Pasted preview" />
            </div>
            <label class="switch-row">
              <span class="switch-label">Web Search</span>
              <span class="switch-control">
                <input id="web-search-toggle" type="checkbox" />
                <span class="switch-slider" aria-hidden="true"></span>
              </span>
            </label>
            <button id="extract-image-btn" class="btn" type="button">Extract Fields</button>
          </section>

          <section class="card">
            <h2>Notes</h2>
            <p>
              Manual Add/Delete Connection is currently deprecated and disabled. We may reopen it
              in a future update.
            </p>
            <p>For now, adding people is expected to auto-populate and auto-connect the graph.</p>
          </section>

          <section class="card" id="person-details-card">
            <h2>Person Details</h2>
            <div id="person-details-empty">
              <p>Select a node in the graph to inspect details.</p>
            </div>
            <div id="person-details-content" class="hidden">
              <p id="person-summary"></p>
              <button id="delete-person-btn" class="btn btn-danger">Delete Person</button>
            </div>
          </section>
        </aside>
      </main>
    </div>

    <div id="toast" class="toast hidden"></div>
    <script src="https://unpkg.com/cytoscape@3.28.1/dist/cytoscape.min.js"></script>
    <script src="/static/app.js?v=20260211-websearch-switch" type="module"></script>
  </body>
</html>
